2022-04-20 16:50:25.438385: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2022-04-20 16:50:25.438446: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
[32m[04/20 16:50:26 valid-selec]: [0mFull config saved to /data3/wuyinjun/valid_set_selections/mnist_1//rand_error_0.6_valid_select_seq_select_0_all_layer_3/config.json
[32m[04/20 16:50:26 valid-selec]: [0mstart
[32m[04/20 16:50:26 valid-selec]: [0m==> Preparing data..
[32m[04/20 16:50:29 valid-selec]: [0m==> Loading cached model...
[32m[04/20 16:50:29 valid-selec]: [0m==> Loading cached model successfully
[32m[04/20 16:50:30 valid-selec]: [0msample batch ids::0
[32m[04/20 16:50:37 valid-selec]: [0msample batch ids::1
[32m[04/20 16:50:43 valid-selec]: [0msample batch ids::2
[32m[04/20 16:50:50 valid-selec]: [0msample batch ids::3
[32m[04/20 16:50:56 valid-selec]: [0msample batch ids::4
[32m[04/20 16:51:03 valid-selec]: [0msample batch ids::5
[32m[04/20 16:51:09 valid-selec]: [0msample batch ids::6
[32m[04/20 16:51:16 valid-selec]: [0msample batch ids::7
[32m[04/20 16:51:22 valid-selec]: [0msample batch ids::8
[32m[04/20 16:51:29 valid-selec]: [0msample batch ids::9
[32m[04/20 16:51:35 valid-selec]: [0msample batch ids::10
[32m[04/20 16:51:42 valid-selec]: [0msample batch ids::11
[32m[04/20 16:51:48 valid-selec]: [0msample batch ids::12
[32m[04/20 16:51:54 valid-selec]: [0msample batch ids::13
[32m[04/20 16:52:00 valid-selec]: [0msample batch ids::14

running k-means on cuda..
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:28, ?it/s, center_shift=63714.339844, iteration=1, tol=0.000100][running kmeans]: 1it [00:28, 28.74s/it, center_shift=63714.339844, iteration=1, tol=0.000100][running kmeans]: 1it [01:00, 28.74s/it, center_shift=4121.860840, iteration=2, tol=0.000100] [running kmeans]: 2it [01:00, 30.79s/it, center_shift=4121.860840, iteration=2, tol=0.000100][running kmeans]: 2it [01:28, 30.79s/it, center_shift=1453.911865, iteration=3, tol=0.000100][running kmeans]: 3it [01:28, 29.21s/it, center_shift=1453.911865, iteration=3, tol=0.000100][running kmeans]: 3it [01:58, 29.21s/it, center_shift=1014.421570, iteration=4, tol=0.000100][running kmeans]: 4it [01:58, 29.66s/it, center_shift=1014.421570, iteration=4, tol=0.000100][running kmeans]: 4it [02:25, 29.66s/it, center_shift=280.880096, iteration=5, tol=0.000100] [running kmeans]: 5it [02:25, 28.70s/it, center_shift=280.880096, iteration=5, tol=0.000100][running kmeans]: 5it [02:52, 28.70s/it, center_shift=108.853828, iteration=6, tol=0.000100][running kmeans]: 6it [02:52, 28.02s/it, center_shift=108.853828, iteration=6, tol=0.000100][running kmeans]: 6it [03:18, 28.02s/it, center_shift=71.304039, iteration=7, tol=0.000100] [running kmeans]: 7it [03:18, 27.56s/it, center_shift=71.304039, iteration=7, tol=0.000100][running kmeans]: 7it [03:46, 27.56s/it, center_shift=70.636276, iteration=8, tol=0.000100][running kmeans]: 8it [03:46, 27.46s/it, center_shift=70.636276, iteration=8, tol=0.000100][running kmeans]: 8it [04:14, 27.46s/it, center_shift=55.441326, iteration=9, tol=0.000100][running kmeans]: 9it [04:14, 27.58s/it, center_shift=55.441326, iteration=9, tol=0.000100][running kmeans]: 9it [04:42, 27.58s/it, center_shift=35.751663, iteration=10, tol=0.000100][running kmeans]: 10it [04:42, 27.72s/it, center_shift=35.751663, iteration=10, tol=0.000100][running kmeans]: 10it [05:09, 27.72s/it, center_shift=22.884981, iteration=11, tol=0.000100][running kmeans]: 11it [05:09, 27.64s/it, center_shift=22.884981, iteration=11, tol=0.000100][running kmeans]: 11it [05:37, 27.64s/it, center_shift=22.725264, iteration=12, tol=0.000100][running kmeans]: 12it [05:37, 27.67s/it, center_shift=22.725264, iteration=12, tol=0.000100][running kmeans]: 12it [06:04, 27.67s/it, center_shift=18.717203, iteration=13, tol=0.000100][running kmeans]: 13it [06:04, 27.56s/it, center_shift=18.717203, iteration=13, tol=0.000100][running kmeans]: 13it [06:30, 27.56s/it, center_shift=12.773171, iteration=14, tol=0.000100][running kmeans]: 14it [06:30, 27.18s/it, center_shift=12.773171, iteration=14, tol=0.000100][running kmeans]: 14it [06:57, 27.18s/it, center_shift=6.006456, iteration=15, tol=0.000100] [running kmeans]: 15it [06:57, 26.89s/it, center_shift=6.006456, iteration=15, tol=0.000100][running kmeans]: 15it [07:23, 26.89s/it, center_shift=4.237206, iteration=16, tol=0.000100][running kmeans]: 16it [07:23, 26.66s/it, center_shift=4.237206, iteration=16, tol=0.000100][running kmeans]: 16it [07:49, 26.66s/it, center_shift=2.155185, iteration=17, tol=0.000100][running kmeans]: 17it [07:49, 26.56s/it, center_shift=2.155185, iteration=17, tol=0.000100][running kmeans]: 17it [08:16, 26.56s/it, center_shift=1.530650, iteration=18, tol=0.000100][running kmeans]: 18it [08:16, 26.61s/it, center_shift=1.530650, iteration=18, tol=0.000100][running kmeans]: 18it [08:42, 26.61s/it, center_shift=0.697260, iteration=19, tol=0.000100][running kmeans]: 19it [08:42, 26.62s/it, center_shift=0.697260, iteration=19, tol=0.000100][running kmeans]: 19it [09:10, 26.62s/it, center_shift=0.449137, iteration=20, tol=0.000100][running kmeans]: 20it [09:10, 26.87s/it, center_shift=0.449137, iteration=20, tol=0.000100][running kmeans]: 20it [09:37, 26.87s/it, center_shift=0.237748, iteration=21, tol=0.000100][running kmeans]: 21it [09:37, 27.00s/it, center_shift=0.237748, iteration=21, tol=0.000100][running kmeans]: 21it [10:04, 27.00s/it, center_shift=0.185979, iteration=22, tol=0.000100][running kmeans]: 22it [10:04, 27.01s/it, center_shift=0.185979, iteration=22, tol=0.000100][running kmeans]: 22it [10:31, 27.01s/it, center_shift=0.143037, iteration=23, tol=0.000100][running kmeans]: 23it [10:31, 27.07s/it, center_shift=0.143037, iteration=23, tol=0.000100][running kmeans]: 23it [10:59, 27.07s/it, center_shift=0.147484, iteration=24, tol=0.000100][running kmeans]: 24it [10:59, 27.20s/it, center_shift=0.147484, iteration=24, tol=0.000100][running kmeans]: 24it [11:26, 27.20s/it, center_shift=0.055246, iteration=25, tol=0.000100][running kmeans]: 25it [11:26, 27.28s/it, center_shift=0.055246, iteration=25, tol=0.000100][running kmeans]: 25it [11:54, 27.28s/it, center_shift=0.086336, iteration=26, tol=0.000100][running kmeans]: 26it [11:54, 27.29s/it, center_shift=0.086336, iteration=26, tol=0.000100][running kmeans]: 26it [12:21, 27.29s/it, center_shift=0.044436, iteration=27, tol=0.000100][running kmeans]: 27it [12:21, 27.32s/it, center_shift=0.044436, iteration=27, tol=0.000100][running kmeans]: 27it [12:48, 27.32s/it, center_shift=0.011167, iteration=28, tol=0.000100][running kmeans]: 28it [12:48, 27.19s/it, center_shift=0.011167, iteration=28, tol=0.000100][running kmeans]: 28it [13:14, 27.19s/it, center_shift=0.026687, iteration=29, tol=0.000100][running kmeans]: 29it [13:14, 26.94s/it, center_shift=0.026687, iteration=29, tol=0.000100][running kmeans]: 29it [13:41, 26.94s/it, center_shift=0.013310, iteration=30, tol=0.000100][running kmeans]: 30it [13:41, 26.93s/it, center_shift=0.013310, iteration=30, tol=0.000100][running kmeans]: 30it [14:08, 26.93s/it, center_shift=0.025206, iteration=31, tol=0.000100][running kmeans]: 31it [14:08, 26.87s/it, center_shift=0.025206, iteration=31, tol=0.000100][running kmeans]: 31it [14:35, 26.87s/it, center_shift=0.027294, iteration=32, tol=0.000100][running kmeans]: 32it [14:35, 26.80s/it, center_shift=0.027294, iteration=32, tol=0.000100][running kmeans]: 32it [15:01, 26.80s/it, center_shift=0.038251, iteration=33, tol=0.000100][running kmeans]: 33it [15:01, 26.79s/it, center_shift=0.038251, iteration=33, tol=0.000100][running kmeans]: 33it [15:29, 26.79s/it, center_shift=0.024239, iteration=34, tol=0.000100][running kmeans]: 34it [15:29, 26.98s/it, center_shift=0.024239, iteration=34, tol=0.000100][running kmeans]: 34it [15:55, 26.98s/it, center_shift=0.024599, iteration=35, tol=0.000100][running kmeans]: 35it [15:55, 26.89s/it, center_shift=0.024599, iteration=35, tol=0.000100][running kmeans]: 35it [16:22, 26.89s/it, center_shift=0.013088, iteration=36, tol=0.000100][running kmeans]: 36it [16:22, 26.90s/it, center_shift=0.013088, iteration=36, tol=0.000100][running kmeans]: 36it [16:49, 26.90s/it, center_shift=0.004148, iteration=37, tol=0.000100][running kmeans]: 37it [16:49, 26.94s/it, center_shift=0.004148, iteration=37, tol=0.000100][running kmeans]: 37it [17:17, 26.94s/it, center_shift=0.006748, iteration=38, tol=0.000100][running kmeans]: 38it [17:17, 27.06s/it, center_shift=0.006748, iteration=38, tol=0.000100][running kmeans]: 38it [17:44, 27.06s/it, center_shift=0.003092, iteration=39, tol=0.000100][running kmeans]: 39it [17:44, 27.16s/it, center_shift=0.003092, iteration=39, tol=0.000100][running kmeans]: 39it [18:11, 27.16s/it, center_shift=0.002545, iteration=40, tol=0.000100][running kmeans]: 40it [18:11, 27.19s/it, center_shift=0.002545, iteration=40, tol=0.000100][running kmeans]: 40it [18:38, 27.19s/it, center_shift=0.003268, iteration=41, tol=0.000100][running kmeans]: 41it [18:38, 27.02s/it, center_shift=0.003268, iteration=41, tol=0.000100][running kmeans]: 41it [19:04, 27.02s/it, center_shift=0.002200, iteration=42, tol=0.000100][running kmeans]: 42it [19:04, 26.82s/it, center_shift=0.002200, iteration=42, tol=0.000100][running kmeans]: 42it [19:31, 26.82s/it, center_shift=0.004085, iteration=43, tol=0.000100][running kmeans]: 43it [19:31, 26.66s/it, center_shift=0.004085, iteration=43, tol=0.000100][running kmeans]: 43it [19:57, 26.66s/it, center_shift=0.005150, iteration=44, tol=0.000100][running kmeans]: 44it [19:57, 26.67s/it, center_shift=0.005150, iteration=44, tol=0.000100][running kmeans]: 44it [20:24, 26.67s/it, center_shift=0.002168, iteration=45, tol=0.000100][running kmeans]: 45it [20:24, 26.74s/it, center_shift=0.002168, iteration=45, tol=0.000100][running kmeans]: 45it [20:51, 26.74s/it, center_shift=0.000553, iteration=46, tol=0.000100][running kmeans]: 46it [20:51, 26.85s/it, center_shift=0.000553, iteration=46, tol=0.000100][running kmeans]: 46it [21:19, 26.85s/it, center_shift=0.007563, iteration=47, tol=0.000100][running kmeans]: 47it [21:19, 27.04s/it, center_shift=0.007563, iteration=47, tol=0.000100][running kmeans]: 47it [21:46, 27.04s/it, center_shift=0.005825, iteration=48, tol=0.000100][running kmeans]: 48it [21:46, 27.17s/it, center_shift=0.005825, iteration=48, tol=0.000100][running kmeans]: 48it [22:13, 27.17s/it, center_shift=0.016499, iteration=49, tol=0.000100][running kmeans]: 49it [22:13, 27.16s/it, center_shift=0.016499, iteration=49, tol=0.000100][running kmeans]: 49it [22:41, 27.16s/it, center_shift=0.017159, iteration=50, tol=0.000100][running kmeans]: 50it [22:41, 27.19s/it, center_shift=0.017159, iteration=50, tol=0.000100]