# How to run the code for validation set selections


Example usage of my code for training a clean model on the fully cleaned version of MNIST dataset (suppose the log directory is /path/to/logs/,  the data directory is /path/to/data/ and the gpu is is ${gpu_id})

```
cd src/main/
python main_train.py --gpu_id ${gpu_id} --save_path /path/to/logs/ --data_dir /path/to/data/ --cuda --lr 0.2 --batch_size 4096 --test_batch_size 256 --epochs 100

```

To prepare for running my code for our method, we need to cache the resulting model by using the above command, i.e.:
```
cp /path/to/logs/model_99 /path/to/data/model_full
```


Example usage of my code for randomly selecting validation samples:

```
python main_train.py --valid_ratio 0.005 --meta_lr 50 --err_label_ratio 0.7 --flip_labels --gpu_id ${gpu_id} --save_path /path/to/logs/ --data_dir /path/to/data/ --cuda --lr 0.2 --batch_size 4096 --test_batch_size 256 --epochs 400
```

in which "--flip_labels" determines whether to pollute the training set and  "--err_label_ratio" determine how many samples are polluted.

Example usage of my code by using my method:

```
python main_train.py  --select_valid_set --load_dataset  --valid_ratio 0.005 --meta_lr 50 --err_label_ratio 0.7 --flip_labels --gpu_id ${gpu_id} --save_path /path/to/logs/ --data_dir /path/to/data/ --cuda --lr 0.2 --batch_size 4096 --test_batch_size 256 --epochs 400
```
in which "--select_valid_set" determines the use of my method and "--load_dataset" is used to load the existing dirty datasets (generated by the previous command), which is for fair comparison since the noisy labels are randomly generated.
